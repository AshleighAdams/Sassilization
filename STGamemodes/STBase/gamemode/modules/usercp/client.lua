---------------------- STBase-- By Spacetech--------------------UserCP = {}UserCP.Players = {}UserCP.NewPlayers = {}local StatusSpace = 10local function CalcDisplayStatus( status, index )		if !(status and status != "") then return "" end	surface.SetFont( "bScoreboardText" )		if (surface.GetTextSize( status ) < 61) then		return status	end		status = status .. string.rep( " ", StatusSpace )	local length = status:len()		local endpos = index	local width = surface.GetTextSize( status:sub( index, endpos ) )	while( width < 60 ) do		endpos = endpos + 1		if (endpos > length) then			status = status .. status		end		width = surface.GetTextSize( status:sub( index, endpos ) )	end		return status:sub( index, endpos )	endlocal function UpdateStatusIndex()		for id, pl in pairs( UserCP.NewPlayers ) do		if (CurTime() >= pl.status.nextScroll) then			pl.status.index = pl.status.index + 1			if (pl.status.index > pl.status.full:len() + StatusSpace) then				pl.status.index = 1				pl.status.nextScroll = CurTime() + 3			end			pl.status.display = CalcDisplayStatus( pl.status.full, pl.status.index )		end	end	endtimer.Create( "UpdateStatusIndex", 0.25, 0, function() UpdateStatusIndex() end )function UserCP.AddPlayer( um )	local sid = um:ReadString()	local pl = UserCP.Players[sid] or {}	pl.steamid = sid	pl.name = um:ReadString()	pl.rank = string.lower(um:ReadString())	pl.dough = math.Round(um:ReadLong())	local status = um:ReadString()	local oldstatus = pl.status and pl.status.full or ""	pl.status = pl.status or {}	pl.status.full = status != "" and status or (pl.status.full or "")	pl.status.index = status == oldstatus and (pl.status.index or 1) or 1	pl.status.display = CalcDisplayStatus( pl.status.full, pl.status.index )	pl.status.nextScroll = CurTime()	UserCP.Players[pl.steamid] = plendusermessage.Hook( "UserCP.AddPlayer", UserCP.AddPlayer )function UserCP.RemovePlayer( um )	local steamid = um:ReadString()	if UserCP.Players[steamid] then		UserCP.Players[steamid] = nil	endendusermessage.Hook( "UserCP.RemovePlayer", UserCP.RemovePlayer )-- Remove the old txt file if it existsif file.Exists("sassilization/forumlist.txt", "DATA") then file.Delete("sassilization/forumlist.txt") end UserCPOnlineListCVar = CreateClientConVar( "st_forumonlinelist", "1", true, false )local EnabledConVar = UserCPOnlineListCVarfunction UserCP.WebsiteOnlineList( users )	-- UserCP.Players = {}	UserCP.NewPlayers = {}		if !users or users == "" or users == "N/A" or (string.find(users, "<html>") and string.find(users, "</html>")) then return end 	-- local Table = string.Explode( "[-*]", users )	local Table = Json.Decode(users)	for k,v in pairs( Table ) do 		-- v = string.Explode( "[*-]", v )		if v[1] and v[2] and v[3] and v[4] then 			local pl = {}			pl.steamid = v[4]			pl.actual = STGamemodes.FindByPartial( pl.steamid )			if STValidEntity(pl.actual) and pl.actual:IsFake() then pl.actual = nil end 			pl.name = v[1]			pl.rank = string.lower(STGamemodes:NumberToRank(v[2]))			pl.rankn = tonumber(v[2])			pl.dough = v[3]			pl.status = {}			pl.status.full = v[5] or "Browsing the Forums"			pl.status.index = 1			pl.status.display = CalcDisplayStatus( pl.status.full, pl.status.index )			pl.status.nextScroll = CurTime()			table.insert( UserCP.NewPlayers, pl )		end 	end endfunction STGamemodes.LoadList()	http.Fetch("<URL HERE>", function(content) UserCP.WebsiteOnlineList(content) end )end if EnabledConVar:GetInt() == 1 then 	STGamemodes.LoadList()	timer.Create( "UserCP.UpdateOnlineList", 60, 0, function() STGamemodes.LoadList() end )end function STGamemodes.ForumListToggle(ply)	if EnabledConVar:GetInt() == 1  then 		RunConsoleCommand( "st_forumonlinelist", "0" )	else 		RunConsoleCommand( "st_forumonlinelist", "1" )	end 	if EnabledConVar:GetInt() == 1 then 		UserCP.NewPlayers = {}		timer.Destroy( "UserCP.UpdateOnlineList" )		ply:ChatPrint( "Forum Online List: Disabled" )	else 		STGamemodes.LoadList()		timer.Create( "UserCP.UpdateOnlineList", 120, 0, function() STGamemodes.LoadList() end )		ply:ChatPrint( "Forum Online List: Enabled" )	end 	STGamemodes.Store.RefreshSettings = trueend concommand.Add( "st_forumonline", STGamemodes.ForumListToggle )